(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-028d6d3a"],{"048e":function(e,i,t){"use strict";t.r(i);var n=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"shop-config-container"},[t("el-form",{ref:"configForm",staticClass:"config-form",attrs:{model:e.configInfo,"label-width":"300px"}},[t("el-form-item",{attrs:{label:"商城Logo",required:""}},[t("el-avatar",{attrs:{size:50,src:e.configInfo.logo}})],1),t("el-form-item",{attrs:{label:"商城名称",required:""}},[t("el-input",{attrs:{placeholder:"请输入商城名称"},model:{value:e.configInfo.name,callback:function(i){e.$set(e.configInfo,"name",i)},expression:"configInfo.name"}})],1),t("el-form-item",{attrs:{label:"营业时间",required:""}},[t("el-input",{attrs:{placeholder:"请输入营业时间"},model:{value:e.configInfo.businessHours,callback:function(i){e.$set(e.configInfo,"businessHours",i)},expression:"configInfo.businessHours"}})],1),t("el-form-item",{attrs:{label:"联系电话",required:""}},[t("el-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.configInfo.phone,callback:function(i){e.$set(e.configInfo,"phone",i)},expression:"configInfo.phone"}})],1),t("el-form-item",{attrs:{label:"地址",required:""}},[t("el-input",{attrs:{placeholder:"请输入商城地址"},model:{value:e.configInfo.address,callback:function(i){e.$set(e.configInfo,"address",i)},expression:"configInfo.address"}})],1),t("el-form-item",{attrs:{label:"商城描述图片",required:""}},[t("el-row",{attrs:{gutter:20}},e._l(e.configInfo.imageUrlList,(function(e){return t("div",{staticClass:"block"},[t("el-col",{attrs:{span:6}},[t("el-avatar",{attrs:{shape:"square",size:150,src:e}})],1)],1)})),0)],1),t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"LOGO",required:""}},[t("image-upload",{model:{value:e.configInfo.logo,callback:function(i){e.$set(e.configInfo,"logo",i)},expression:"configInfo.logo"}}),t("br"),t("el-button",{attrs:{loading:e.btnLoading,type:"primary"},nativeOn:{click:function(i){return i.preventDefault(),e.UpdateShopConfig(i)}}},[e._v("提交商城配置信息")])],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"ImageList",required:""}},[t("image-list-upload",{model:{value:e.configInfo.imageUrlList,callback:function(i){e.$set(e.configInfo,"imageUrlList",i)},expression:"configInfo.imageUrlList"}})],1)],1)],1)],1)],1)},a=[],o=(t("b0c0"),t("d3b7"),function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("el-upload",{attrs:{"list-type":"picture-card",action:"",limit:1,"http-request":e.handleImageUpload,"before-upload":e.beforeImageUpload,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleImageRemove,"on-exceed":e.handleImageExceed}},[t("i",{staticClass:"el-icon-plus"})]),t("el-dialog",{attrs:{visible:e.imageDialogVisible},on:{"update:visible":function(i){e.imageDialogVisible=i}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)}),r=[],s=(t("4de4"),t("ac1f"),t("1276"),t("34b8")),l=t("5f72"),c=t("ed08"),g=t("11c1"),u={model:{prop:"imageUrl",event:"update"},props:{imageUrl:{type:String,default:""}},data:function(){return{imageDialogVisible:!1,imageList:[]}},watch:{imageList:{handler:function(e){e&&e.length?this.imageUrl="https://beiyipu.oss-cn-beijing.aliyuncs.com/images/"+e[0].filename:this.imageUrl=""},deep:!0},imageUrl:{handler:function(e){this.$emit("update",e)}}},methods:{handleImageUpload:function(e){var i=this;try{var t=e.file.name.split(".");if(!t||t.length<=1)return l["Message"].error("文件名称不正确");var n=Object(g["v4"])()+"."+t.reverse()[0],a=l["Loading"].service({lock:!0,text:"图片上传中，请稍后",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(s["a"])(n,e.file).then((function(t){return i.imageList.push({uid:e.file.uid,filename:n})})).catch((function(e){return l["Message"].error(Object(c["a"])(e))})).finally((function(){return a.close()}))}catch(o){l["Message"].error(Object(c["a"])(o))}},beforeImageUpload:function(e){var i="image/jpeg"===e.type||"image/png"===e.type;i||l["Message"].error("上传图片只能是 JPG 或PNG格式");var t=e.size/1024/1024<10;return t||l["Message"].error("上传图片大小不能超过 10MB"),i&&t},handleImageRemove:function(e){this.imageList=this.imageList.filter((function(i){return i.uid!==e.uid}))},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.imageDialogVisible=!0},handleImageExceed:function(){l["Message"].warning("最多只能上传1张图片")}}},f=u,d=t("2877"),m=Object(d["a"])(f,o,r,!1,null,"0d5e814b",null),p=m.exports,h=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("el-upload",{attrs:{"list-type":"picture-card",action:"",limit:10,"http-request":e.handleImageUpload,"before-upload":e.beforeImageUpload,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleImageRemove,"on-exceed":e.handleImageExceed}},[t("i",{staticClass:"el-icon-plus"})]),t("el-dialog",{attrs:{visible:e.imageDialogVisible},on:{"update:visible":function(i){e.imageDialogVisible=i}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},b=[],I=(t("d81d"),{model:{prop:"imageUrlList",event:"update"},props:{imageUrlList:{type:Array,default:[]}},data:function(){return{imageDialogVisible:!1,imageList:[]}},watch:{imageList:{handler:function(e){e&&e.length?this.imageUrlList=e.map((function(e){return"https://beiyipu.oss-cn-beijing.aliyuncs.com/images/"+e.filename})):this.posterUrl=""},deep:!0},imageUrlList:{handler:function(e){this.$emit("update",e)}}},methods:{handleImageUpload:function(e){var i=this;try{var t=e.file.name.split(".");if(!t||t.length<=1)return l["Message"].error("文件名称不正确");var n=Object(g["v4"])()+"."+t.reverse()[0],a=l["Loading"].service({lock:!0,text:"宣传图片上传中，请稍后",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(s["a"])(n,e.file).then((function(t){return i.imageList.push({uid:e.file.uid,filename:n})})).catch((function(e){return l["Message"].error(Object(c["a"])(e))})).finally((function(){return a.close()}))}catch(o){l["Message"].error(Object(c["a"])(o))}},beforeImageUpload:function(e){var i="image/jpeg"===e.type||"image/png"===e.type;i||l["Message"].error("宣传图片只能是 JPG 或PNG格式");var t=e.size/1024/1024<10;return t||l["Message"].error("宣传图片大小不能超过 10MB"),i&&t},handleImageRemove:function(e){this.imageList=this.imageList.filter((function(i){return i.uid!==e.uid}))},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.imageDialogVisible=!0},handleImageExceed:function(){l["Message"].warning("最多只能上传10张宣传图片")}}}),v=I,L=Object(d["a"])(v,h,b,!1,null,"70006318",null),U=L.exports,w=t("b775");function y(e,i,t,n,a,o){return Object(w["a"])({url:"/admin/shop/config",method:"put",data:{Logo:e,Name:i,Phone:t,BusinessHours:n,Address:a,ImageUrlList:o}})}function j(){return Object(w["a"])({url:"/admin/shop/config",method:"get"})}var x={components:{ImageUpload:p,ImageListUpload:U},data:function(){return{btnLoading:!1,configInfo:{logo:"",name:"",phone:"",businessHours:"",address:"",imageUrlList:[]}}},created:function(){var e=this;j().then((function(i){console.log(i),i&&(e.configInfo.logo=i.Logo,e.configInfo.name=i.Name,e.configInfo.phone=i.Phone,e.configInfo.businessHours=i.BusinessHours,e.configInfo.address=i.Address,e.configInfo.imageUrlList=i.ImageUrlList)})).catch((function(e){return l["Message"].error(Object(c["a"])(e))}))},methods:{UpdateShopConfig:function(){var e=this;this.btnLoading=!0,y(this.configInfo.logo,this.configInfo.name,this.configInfo.phone,this.configInfo.businessHours,this.configInfo.address,this.configInfo.imageUrlList).then((function(e){e.Result&&alert("商城配置信息更新成功")})).catch((function(e){return ELEMENT.Message.error(Object(c["a"])(e))})).finally((function(){e.btnLoading=!1}))}}},O=x,M=(t("7a0f"),Object(d["a"])(O,n,a,!1,null,"c029e27a",null));i["default"]=M.exports},2422:function(e,i,t){},"7a0f":function(e,i,t){"use strict";t("2422")}}]);